<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grafix | Premium Design Studio</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <nav>
        <a href="/" class="logo">GRAFIX.</a>
        <div class="nav-links">
            <a href="/" class="active">Home</a>
            <a href="/products">Products</a>
            <a href="/blog">Blog</a>
            <a href="/about">About</a>
            <a href="/contact">Contact</a>
            <a href="/login" class="btn"
                style="padding: 0.4rem 1rem; font-size: 0.8rem; border: 1px solid var(--primary); color: var(--primary);">Portal</a>
        </div>
    </nav>

    <header class="hero">
        <h1 class="animate">Visualizing Tomorrow,<br>Designing Today.</h1>
        <p class="animate" style="animation-delay: 0.2s;">Grafix is a premier digital studio specializing in premium
            brand assets and cutting-edge visual identities.</p>
        <div class="animate" style="animation-delay: 0.4s; margin-top: 2rem;">
            <a href="/products" class="btn btn-primary">Our Products</a>
            <a href="/contact" class="btn" style="border: 1px solid white; color: white; margin-left: 1rem;">Work With
                Us</a>
        </div>
    </header>

    <section class="section">
        <div class="section-content">
            <h2 class="section-title">Our Premium Products</h2>
            <div id="products-grid" class="dashboard-grid"
                style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
                <p style="text-align: center; color: var(--text-muted); grid-column: 1/-1;">Loading assets...</p>
            </div>
        </div>
    </section>

    <section class="section section-alt">
        <div class="section-content">
            <h2 class="section-title">Our Dynamic Team</h2>
            <div id="team-grid" class="grid"
                style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem;">
                <!-- Staff loaded from DB -->
                <p style="text-align: center; color: var(--text-muted); grid-column: 1/-1;">Loading team...</p>
            </div>
        </div>
    </section>

    <footer style="padding: 4rem 8%; background: #070b14; border-top: 1px solid rgba(255,255,255,0.05);">
        <div id="footer-content"
            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 4rem;">
            <!-- Business Info Loaded from DB -->
        </div>
    </footer>

    <script>
        // Analytics/Log visitor
        fetch('/api/log');

        async function loadContent() {
            try {
                // Load Products from MySQL API
                const prodRes = await fetch('/api/products');
                const products = await prodRes.json();
                const productsGrid = document.getElementById('products-grid');
                productsGrid.innerHTML = products.slice(0, 3).map(product => `
                    <div class="product-preview-card animate">
                        <img src="${product.image_url || '/images/card1.png'}" class="product-preview-img" alt="${product.name}">
                        <div class="product-preview-content">
                            <h3>${product.name}</h3>
                            <p style="color: var(--primary); font-weight: 800; font-size: 1.2rem; margin: 0.5rem 0;">${product.price}</p>
                            <p style="font-size: 0.9rem; color: var(--text-muted); line-height: 1.5; margin-bottom: 1.5rem;">${product.description}</p>
                            <a href="/contact" class="btn btn-primary" style="width: 100%; text-align: center; display: block;">Inquire Now</a>
                        </div>
                    </div>
                `).join('');

                // Load Team from MySQL API
                const teamRes = await fetch('/api/staff');
                const staff = await teamRes.json();
                const teamGrid = document.getElementById('team-grid');
                if (staff.length > 0) {
                    teamGrid.innerHTML = staff.map(member => `
                        <div class="card animate" style="text-align: center;">
                            <img src="${member.image_url || '/images/card1.png'}" style="width: 100px; height: 100px; border-radius: 50%; border: 2px solid var(--primary); padding: 5px; margin-bottom: 1rem;">
                            <h4>${member.name}</h4>
                            <p style="color: var(--primary); font-size: 0.8rem;">${member.role}</p>
                        </div>
                    `).join('');
                } else {
                    teamGrid.innerHTML = '<p style="grid-column: 1/-1; text-align: center;">Team members coming soon.</p>';
                }

                // Load Footer Info
                const bizRes = await fetch('/api/business');
                const biz = await bizRes.json();
                const footer = document.getElementById('footer-content');
                footer.innerHTML = `
                    <div>
                        <a href="/" class="logo" style="margin-bottom: 1.5rem; display: block;">${biz.company_name || 'GRAFIX'}.</a>
                        <p style="color: var(--text-muted);"> professional studio specializing in premium digital assets.</p>
                    </div>
                    <div>
                        <h4 style="margin-bottom: 1.5rem;">Contact</h4>
                        <p style="color: var(--text-muted);">${biz.email}<br>${biz.address || 'Global Studio'}<br>${biz.phone}</p>
                    </div>
                `;

            } catch (err) {
                console.error('Error loading dynamic content:', err);
            }
        }
        loadContent();
    </script>
</body>

</html>