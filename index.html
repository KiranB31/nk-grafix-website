<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grafix | Premium Design Studio</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <nav>
        <a href="/" class="logo" id="header-logo">GRAFIX.</a>
        <div class="nav-links">
            <a href="/" class="active">Home</a>
            <a href="/products">Products</a>
            <a href="/blog">Blog</a>
            <a href="/about">About</a>
            <a href="/contact">Contact</a>
            <a href="/login" class="btn"
                style="padding: 0.4rem 1rem; font-size: 0.8rem; border: 1px solid var(--primary); color: var(--primary);">Portal</a>
        </div>
    </nav>

    <header class="hero">
        <h1 class="animate">Visualizing Tomorrow,<br>Designing Today.</h1>
        <p id="hero-sub" class="animate" style="animation-delay: 0.2s;">Grafix is a premier digital studio specializing
            in premium brand assets.</p>
        <div class="animate" style="animation-delay: 0.4s; margin-top: 2rem;">
            <a href="/products" class="btn btn-primary">Our Products</a>
            <a href="/contact" class="btn" style="border: 1px solid white; color: white; margin-left: 1rem;">Work With
                Us</a>
        </div>
    </header>

    <section class="section">
        <div class="section-content">
            <h2 class="section-title">Our Premium Products</h2>
            <div id="products-grid" class="dashboard-grid"
                style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
                <p style="text-align: center; color: var(--text-muted); grid-column: 1/-1;">Loading assets...</p>
            </div>
        </div>
    </section>

    <section class="section section-alt">
        <div class="section-content">
            <h2 class="section-title">Insights from our Blog</h2>
            <div id="blog-grid" class="blog-grid">
                <!-- Blog loaded from DB -->
                <p style="text-align: center; color: var(--text-muted); grid-column: 1/-1;">Loading blog...</p>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="section-content">
            <h2 class="section-title">Our Team</h2>
            <div id="team-grid" class="grid"
                style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem;">
                <p style="text-align: center; color: var(--text-muted); grid-column: 1/-1;">Loading team...</p>
            </div>
        </div>
    </section>

    <footer style="padding: 4rem 8%; background: #070b14; border-top: 1px solid rgba(255,255,255,0.05);">
        <div id="footer-content"
            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 4rem;">
        </div>
    </footer>

    <script>
        fetch('/api/log');

        async function loadContent() {
            try {
                // Biz Info
                const bizRes = await fetch('/api/business');
                const biz = await bizRes.json();
                document.getElementById('header-logo').innerText = (biz.company_name || 'GRAFIX') + '.';
                document.getElementById('hero-sub').innerText = biz.philosophy ? biz.philosophy.substring(0, 100) + '...' : 'Premium digital studio specializing in brand assets.';

                // Products
                const prodRes = await fetch('/api/products');
                const products = await prodRes.json();
                const productsGrid = document.getElementById('products-grid');
                productsGrid.innerHTML = products.slice(0, 3).map(product => `
                    <div class="product-preview-card animate">
                        <img src="${product.image_url || '/images/card1.png'}" class="product-preview-img" alt="${product.name}">
                        <div class="product-preview-content">
                            <h3>${product.name}</h3>
                            <p style="color: var(--primary); font-weight: 800; font-size: 1.2rem; margin: 0.5rem 0;">${product.price}</p>
                            <p style="font-size: 0.9rem; color: var(--text-muted); line-height: 1.5; margin-bottom: 1.5rem;">${product.description}</p>
                            <a href="/contact" class="btn btn-primary" style="width: 100%; text-align: center; display: block;">Inquire Now</a>
                        </div>
                    </div>
                `).join('');

                // Blog
                const blogRes = await fetch('/api/blog');
                const posts = await blogRes.json();
                const blogGrid = document.getElementById('blog-grid');
                blogGrid.innerHTML = posts.slice(0, 2).map(post => `
                    <article class="blog-card animate">
                        <img src="${post.image_url || '/images/card2.png'}" alt="${post.title}" class="blog-img">
                        <div class="blog-content">
                            <h3>${post.title}</h3>
                            <p style="font-size: 0.8rem; color: var(--text-muted);">${post.content.substring(0, 100)}...</p>
                            <a href="/blog" class="blog-link">Read More</a>
                        </div>
                    </article>
                `).join('');

                // Team
                const teamRes = await fetch('/api/staff');
                const staff = await teamRes.json();
                const teamGrid = document.getElementById('team-grid');
                teamGrid.innerHTML = staff.map(member => `
                    <div class="card animate" style="text-align: center;">
                        <img src="${member.image_url || '/images/card1.png'}" style="width: 80px; height: 80px; border-radius: 50%;">
                        <h4>${member.name}</h4>
                        <p style="color: var(--primary); font-size: 0.7rem;">${member.role}</p>
                    </div>
                `).join('');

                // Footer
                const footer = document.getElementById('footer-content');
                footer.innerHTML = `
                    <div>
                        <div class="logo">${biz.company_name || 'GRAFIX'}</div>
                        <p style="color: var(--text-muted);">Owned by ${biz.owner_name || 'Creative Studio'}.</p>
                    </div>
                    <div>
                        <h4 style="margin-bottom: 1.5rem;">Contact</h4>
                        <p style="color: var(--text-muted);">${biz.email}<br>${biz.address || 'Global'}</p>
                    </div>
                `;

            } catch (err) { console.error(err); }
        }
        loadContent();
    </script>
</body>

</html>